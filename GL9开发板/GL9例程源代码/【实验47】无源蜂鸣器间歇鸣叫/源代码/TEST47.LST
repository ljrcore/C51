C51 COMPILER V7.00  TEST47                                                                 09/18/2012 21:34:53 PAGE 1   


C51 COMPILER V7.00, COMPILATION OF MODULE TEST47
OBJECT MODULE PLACED IN TEST47.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE TEST47.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          ////////////////////////////////////////////////////////////////////////////
   2          //                给力者单片机开发学习系统，开发学习都给力！              //
   3          ////////////////////////////////////////////////////////////////////////////
   4          //                     学习51单片机，其实可以很简单                       //
   5          ////////////////////////////////////////////////////////////////////////////
   6          //                宁波芯动电子有限公司  www.MovingChip.com                //
   7          ////////////////////////////////////////////////////////////////////////////
   8          
   9          #include <AT89X52.h>       //调用51单片机的头文件
  10          
  11          unsigned int k;
  12          unsigned int m;
  13          bit S2bit;              //设置一个位变量，该位写1，蜂鸣器鸣叫，否则停止
  14          
  15          //---------------------------------------
  16          //名称：定时器0中断服务程序
  17          //适用：给力者GL9单片机开发学习系统
  18          //公司：宁波芯动电子有限公司
  19          //网址：www.MovingChip.com
  20          //日期：20120914
  21          //---------------------------------------
  22          void Timer0(void) interrupt 1 
  23          {                          //定时1000微秒
  24   1          TL0=0xCC;              //重新给TL0赋初值
  25   1          TH0=0xF8;              //重新给TH0赋初值
  26   1      
  27   1          //***此处用户自行添加定时器T0中断处理程序***
  28   1              if(S2bit==1)          //如果标志位为1，启动蜂鸣器
  29   1                      P1_2=~P1_2;       //1000us改变一次状态，周期为2000us，频率为500HZ
  30   1              else
  31   1                      P1_2=1;            //如果标志位为0，关闭蜂鸣器
  32   1          //******************************************
  33   1      
  34   1      }
  35          
  36          //---------------------------------------
  37          //名称: 蜂鸣器函数
  38          //适用：给力者GL9单片机开发学习系统
  39          //公司：宁波芯动电子有限公司
  40          //网址：www.MovingChip.com
  41          //日期：20120914
  42          //--------------------------------------- 
  43          void fengpro(void)
  44          {
  45   1              if(S2bit==1)         //如果蜂鸣器鸣叫后，启动定时关闭蜂鸣器鸣叫
  46   1              {
  47   2                      if(++m>2000)   //鸣叫时长为2000个循环周期
  48   2                      {
  49   3                              m=0;
  50   3                              S2bit=0;          //关闭蜂鸣器鸣叫                              
  51   3                      }                       
  52   2              }               
  53   1      }
  54          
  55          //---------------------------------------
C51 COMPILER V7.00  TEST47                                                                 09/18/2012 21:34:53 PAGE 2   

  56          //名称: 主函数
  57          //适用：给力者GL9单片机开发学习系统
  58          //公司：宁波芯动电子有限公司
  59          //网址：www.MovingChip.com
  60          //日期：20120914
  61          //---------------------------------------
  62          void main(void)            //主函数,单片机开机后就是从这个函数开始运行
  63          {
  64   1      
  65   1          //***定时器Timer0初始化***
  66   1          TMOD&=0xF0;            //将TMOD的低4位定时器0控制部分清零
  67   1          TMOD|=0x01;            //设置定时器0为方式1
  68   1          TL0=0xCC;              //设置定时器0初值低8位
  69   1          TH0=0xF8;              //设置定时器0初值高8位
  70   1          TR0=1;                 //启动定时器0
  71   1          ET0=1;                 //Timer0中断允许
  72   1          //**********************
  73   1      
  74   1          //***开全局中断设置****
  75   1          //定时器Timer0设置了中断允许,此处要开全局中断
  76   1          EA=1;                  //开全局中断
  77   1          //*********************
  78   1      
  79   1          while(1)               //死循环,单片机初始化后,将一直运行这个死循环
  80   1          {
  81   2                      if(++k>60000)     //60000个循环后，启动一次蜂鸣器鸣叫
  82   2                      {
  83   3                              k=0;
  84   3                              S2bit=1;      //启动鸣叫
  85   3                      }
  86   2                      fengpro();       //调用蜂鸣器处理函数
  87   2          }
  88   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     99    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
