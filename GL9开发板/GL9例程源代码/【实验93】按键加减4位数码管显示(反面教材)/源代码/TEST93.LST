C51 COMPILER V7.00  TEST93                                                                 01/25/2014 16:17:24 PAGE 1   


C51 COMPILER V7.00, COMPILATION OF MODULE TEST93
OBJECT MODULE PLACED IN TEST93.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE TEST93.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          ////////////////////////////////////////////////////////////////////////////
   2          //                给力者单片机开发学习系统，开发学习都给力！              //
   3          ////////////////////////////////////////////////////////////////////////////
   4          //                     学习51单片机，其实可以很简单                       //
   5          ////////////////////////////////////////////////////////////////////////////
   6          //                宁波芯动电子有限公司  www.MovingChip.com                //
   7          ////////////////////////////////////////////////////////////////////////////
   8          
   9          //注意：本例为反面教材，不建议大家学习使用，只为分析问题使用！
  10          
  11          #include <AT89X52.h>       //调用51单片机的头文件
  12          
  13          //---------------------------------------
  14          //数码管字形表，供显示时查询
  15          unsigned char code LED[10]=
  16          {                          //定义表格一定要使用code，这样会做到程序存储区中
  17              0x3F,                  //"0"的字形表，0B00111111
  18              0x06,                  //"1"的字形表，0B00000110
  19              0x5B,                  //"2"的字形表，0B01011011
  20              0x4F,                  //"3"的字形表，0B01001111
  21              0x66,                  //"4"的字形表，0B01100110
  22              0x6D,                  //"5"的字形表，0B01101101
  23              0x7D,                  //"6"的字形表，0B01111101
  24              0x07,                  //"7"的字形表，0B00000111
  25              0x7F,                  //"8"的字形表，0B01111111
  26              0x6F,                  //"9"的字形表，0B01101111
  27          };
  28          
  29          //---------------------------------------
  30          //4位数码管相关I/O设置
  31          sbit U165A0=P0^0;           //U165(74HC138)的A0脚接在P0.0口上
  32          sbit U165A1=P0^1;           //U165(74HC138)的A1脚接在P0.1口上
  33          sbit U165A2=P0^2;           //U165(74HC138)的A2脚接在P0.2口上
  34          //---------------------------------------
  35          
  36          //---------------------------------------
  37          //名称: 主函数
  38          //适用：给力者GL9单片机开发学习系统
  39          //公司：宁波芯动电子有限公司
  40          //网址：www.MovingChip.com
  41          //日期：20140125
  42          //---------------------------------------
  43          void main(void)            //主函数,单片机开机后就是从这个函数开始运行
  44          {
  45   1      
  46   1         unsigned char c=0;     //定义一个char型变量，做延时用
  47   1         unsigned char d=0;     //定义一个char型变量，控制显示位置
  48   1              unsigned char e=0;     //定义一个char型变量，做延时用
  49   1         unsigned int  f=0;     //定义一个int型变量，显示内容用，显示内容0-9999
  50   1         while(1)               //死循环,单片机初始化后,将一直运行这个死循环
  51   1         {
  52   2      
  53   2            for(c=0;c<250;c++); //做一个0-250的循环，不执行其他操作，只为延时  
  54   2      //----------------------------------------------------------------------------------
  55   2      //以下为按键处理部分
C51 COMPILER V7.00  TEST93                                                                 01/25/2014 16:17:24 PAGE 2   

  56   2         if(P1_0==0)          //如果P1键按下
  57   2              {                       
  58   3                      for(e=0;e<250;e++); //延时若干
  59   3                      if(P1_0==0)             //若干时间后，再次检测按键是否按下      
  60   3                      {       
  61   4                              while(P1_0==0); //等待按键放开
  62   4                              if(++f>9999) f=0;//加1并限制范围为0-9999，因为4位数码管只能显示到9999
  63   4                      }
  64   3          }   
  65   2      //以上为按键部分
  66   2      //-----------------------------------------------------------------------------------
  67   2      //以下为显示部分，按键部分处理f的数值，显示部分负责显示
  68   2            P2=0;              //关一次显示，以免显示出鬼影
  69   2            if(++d>3) d=0;     //先将d加1，然后判断是否大于3，大于3归零
  70   2            if(d==0)           //如果d=0,显示千位
  71   2            {
  72   3               P0=0x1b;       //U165A0=1,U165A1=1,U165A2=0选通数码管的千位进行显示
  73   3               P2=LED[f/1000];          //将要显示的f的千位提取出来查表后送显示 
  74   3            }
  75   2            else if(d==1)      //如果d=1,显示百位
  76   2            {
  77   3               P0=0x1a;       //U165A0=0,U165A1=1,U165A2=0选通数码管的百位进行显示
  78   3               P2=LED[(f%1000)/100];    //将要显示的f的百位提取出来查表后送显示
  79   3            }
  80   2            else if(d==2)      //如果d=2,显示十位
  81   2            {
  82   3              P0=0x19;       //U165A0=1,U165A1=0,U165A2=0选通数码管的十位进行显示
  83   3               P2=LED[(f%100)/10];      //将要显示的f的十位提取出来查表后送显示
  84   3            }
  85   2            else               //如果d=3,显示个位
  86   2            {
  87   3               P0=0x18;       //U165A0=0,U165A1=0,U165A2=0选通数码管的个位进行显示
  88   3               P2=LED[f%10];            //将要显示的f的个位提取出来查表后送显示
  89   3            }
  90   2      //以上为显示部分
  91   2         }
  92   1      }
  93          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    194    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
