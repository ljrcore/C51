/*******************************************************************************
*  标题:                  试验定时中断1使 蜂铃器发声(C语言)                    *
*																			   *
*  连接方法：参照接线图                                                 *
********************************************************************************
*                         	       										       *
* 请学员认真消化本例程，熟练定时中断1的编程                                    *
********************************************************************************/ 

#include < reg51.h >
#include <intrins.h>

sbit Beep = P1^5; 
unsigned int USE_C ; 

  
/*********************************************************
  主函数
**********************************************************/
void  main()
{
    TMOD=0x10;   //定时/计数器1工作于方式1
    TH0=0x4C;	 //定时器初始值
    TL0=0x00;    //50ms定时常数
    EA=1;        //开总中断
    ET1=1;       //允许定时/计数器1 中断
    TR1=1;       //启动定时/计数器1 中断
 
    while(1);
} 


/*********************************************************
  中断服务函数
**********************************************************/
void Time1(void) interrupt 3 // using 0
{
   TH1=0x4c;               //50ms定时
   TL1=0x00;
   if (++USE_C == 20)	  //每隔1秒发声
   { Beep = ~Beep;
	 USE_C = 0;
   }

   
}
/*********************************************************/

