<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">


<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<title>news--Post Message</title>
<meta name="FORMATTER" content="Microsoft FrontPage 2.0">
</head>

<body bgcolor=white>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>电子报新闻和重要文章</title>
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
</head>

<body bgcolor="#FFFFFF">
<style type="text/css">
<!--
.linktop{font-size:9pt}
.linktop a{color: #000000; font-style: normal; text-decoration: none; cursor: hand}
.linktop a:visited {color: rgb(0,0,0); font-style: normal; text-decoration: none}
.linktop a:active  {color:  rgb(100,0,0); font-style: normal; text-decoration: none}
.linktop a:hover {color: rgb(255,255,255); font-style:bold; text-decoration: none}	 
-->
</style>

<div align="center"><center>

<table border="0" width="700" cellspacing="0" cellpadding="0">
  <tr>
    <td width="700" align="center"><a href="/index.asp"><img src="/images/dzblogo.gif" width="228" height="60" border="0"></a><img src="/IMAGES1/kantou1.JPG" border="0" width="279" height="60"><a href="/pav/index.asp"><img src="/IMAGES1/kantou2.jpg" border="0"width="184" height="60"></a></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="0" width="700" cellpadding="4" height="25">
  <tr>
    <td height="11" align="center" bgcolor="#12BEC2" width="77"><span
    style="font-family: 宋体; font-size: 9pt" class="linktop"><a href="/about/aboutus.asp" target="_top">关于我们</a></span></td>
    <td height="11" align="center" bgcolor="#12BEC2" width="78"><span
    style="font-family: 宋体; font-size: 9pt" class="linktop"><a href="#" target="_top">联系方式</a></span></td>
    <td height="11" align="center" bgcolor="#12BEC2" width="78"><span
    style="font-family: 宋体; font-size: 9pt" class="linktop"><a href="/zhongyao/zywz.asp" target="_top">电子报网络版</a></span></td>
    <td height="11" align="center" bgcolor="#12BEC2" width="78"><span
    style="font-family: 宋体; font-size: 9pt" class="linktop"><a href="/bbs/bbs.asp" target="_top">BBS</a></span></td>
   <!--
    <td height="11" align="center" bgcolor="#12BEC2" width="78"><span
    style="font-family: 宋体; font-size: 9pt" class="linktop"><a href="/QuestionAnswer/question/index.htm" target="_top">专家热线</a></span></td>
   -->
    <td height="11" align="center" bgcolor="#12BEC2" width="78"><span
    style="font-family: 宋体; font-size: 9pt" class="linktop"><a href="/shudian/shudian.asp" target="_top">网上书店</a></span></td>
    <td height="11" align="center" bgcolor="#12BEC2" width="78"><span
    style="font-family: 宋体; font-size: 9pt" class="linktop"><a href="/weixiu/wxzlk.asp" target="_top">电子报刊检索</a></span></td>
    <td height="11" align="center" bgcolor="#12BEC2" width="78"><span
    style="font-family: 宋体; font-size: 9pt" class="linktop"><a href="/pav/index.asp" target="_top">实用影音技术</a></span></td>
    <td height="11" align="center" bgcolor="#12BEC2" width="78"><span
    style="font-family: 宋体; font-size: 9pt" class="linktop"><a href="/jiaoliu/jiaoliu.asp" target="_top">个人链接</a></span></td>
  </tr>
</table>
</center></div>
<div align="center"><center>

<div align="center"><center><table border="0" width="650" cellspacing="1" cellpadding="2">
      <tr>
        <td width="100%" valign="top" bgcolor="#DDDDDD"><span style="font-family:宋体;font-size: 9pt"><b><p align="center">新闻和重要文章</b></span></td>
      </tr>
      <tr>
        <td width="100%" valign="top"><span style="font-family:宋体;font-size: 14px">


<strong><BR><p align="center">
<font color="darkblue">利用片内比较器为单片机增加Ａ／Ｄ转换器</strong></font><br>
2002年,第27期,类别:智能电子<br></p>

		<p align="left">&nbsp;&nbsp;&nbsp;&nbsp;许多单片机内部都有模拟比较器，利用该比较器可以构成不同精度的Ａ／Ｄ转换器。本文介绍利用单片机片内比较器构成的三种Ａ／Ｄ转换器。<br>
&nbsp;&nbsp;&nbsp;&nbsp;一、经济型Ａ／Ｄ转换器&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;单片机片内比较器外加一只电阻和一只电容可方便地构成Ａ／Ｄ转换器，其工作原理如图１所示。ＣＰＵ为ＡＴ８９Ｃ２０５１。当Ｐ１．５ 为高电平时，幅值接近Ｖｃｃ的电压通过电阻Ｒ对电容Ｃ充电，当Ｃ上的电压充至与Ｐ１．１脚的被测电压相等时，ＣＰＵ内部的Ｐ３．６由低变高。从Ｐ１．５变高到Ｐ３．６变高的时间与被测电压的关系为Ｖｃ＝Ｖｃｃ（１－ｅ－１／ＲＣ）。其中Ｖｃ为被测电压，Ｖｃｃ为工作电压（通常为５Ｖ），ｔ为充电时间。<br>
　　由此构成的Ａ／Ｄ转换器有以下缺点：１． 精度和线性度较低。受电源电压、逻辑电平的高低、程序执行时间、ＲＣ时间常数等的影响，精度、分辨率、线性度通常低于６～７位。２． Ａ／Ｄ转换时间较长。充放电时间通常为１０ｍｓ左右，且充电时间的延长不能换来Ａ／Ｄ精度、线性度和分辨率的提高。３． 由于充电曲线为非线性指数函数，需用浮点计算。为简化软件设计，常采用查表法。表格中的数据与ＲＣ时间常数、程序执行时间相关，当ＲＣ的值发生变化时，与表中数据的对应关系受到影响，较难补偿。４． Ａ／Ｄ转换的休止期较长，几乎和Ａ／Ｄ转换时间相同。５． 数字逻辑电平的高低影响电容的充放电，直接影响Ａ／Ｄ转换的精度。当用作比较粗糙的Ａ／Ｄ时，此法不失为一个经济的方案。<br>
&nbsp;&nbsp;&nbsp;&nbsp;二、单积分式Ａ／Ｄ转换器<br>
&nbsp;&nbsp;&nbsp;&nbsp;若对Ａ／Ｄ的精度和线性度有更高的要求，可采用图２所示电路。增加的元件不多，但性能得到大幅度提高，此时电容为恒流充放电。当Ｐ１．５为低电平时，Ｒ２、Ｑ２、Ｄ１形成恒流源。假定恒流源用Ｉ０表示，则：<br>
&nbsp;&nbsp;&nbsp;&nbsp;Ｉ０＝（Ｄ１的结电压－Ｑ２的ｅ－ｂ结电压）／Ｒ２……（１）<br>
&nbsp;&nbsp;&nbsp;&nbsp;通常，Ｄ１的结电压为０．７Ｖ左右，Ｑ２的ｅ－ｂ结电压为０．３Ｖ左右，两者在固定的静态工作条件下为定值，因此Ｉ０与Ｒ２成反比。当Ｒ２为定值时，Ｉ０为定值，且与电源电压Ｖｃｃ无关，与Ｐ１．５输出的低电平的幅度关系不大，只要保证Ｑ２导通即可。其工作原理为：当Ｐ１．５为低电平时，Ｑ１截止，恒流源对电容Ｃ１充电。若充电时间为Ｔ，则电容Ｃ１上的电压为<br>
&nbsp;&nbsp;&nbsp;&nbsp;Ｕｃ＝Ｉ０×Ｔ／Ｃ１……（２）<br>
&nbsp;&nbsp;&nbsp;&nbsp;因Ｉ０和Ｃ１为定值，故Ｕｃ与充电时间Ｔ成正比。当Ｃ１上的电压大于被测的输入电压时，８９Ｃ２０５１内部比较器翻转（Ｐ３．６变高），ＣＰＵ只要记下从Ｐ１．５变低到Ｐ３．６变高的时间即为Ａ／Ｄ转换的结果。转换完毕后，Ｐ１．５变为高电平，Ｑ２截止，Ｑ１导通，Ｃ１通过Ｑ１快速放电，完成Ａ／Ｄ转换的复位，为下一次Ａ／Ｄ转换作准备。这就是典型的单积分式Ａ／Ｄ转换器。<br>
　　为便于读者分析和灵活设计，本文给出有用的几组仿真图表和几个计算公式及补偿参数。读者可以根据这些图表选择Ｒ２和Ｃ１，设计不同性能的Ａ／Ｄ转换器。图４中，ａ点波形为ＣＰＵ的Ｐ１．５的输出波形，ＯＵＴ为Ｃ１上的电压波形，也是模拟比较器的一路输入电压。从图４可以清楚地看到Ａ／Ｄ转换器的工作过程。<br>
&nbsp;&nbsp;&nbsp;&nbsp;将ＯＵＴ点的波形放大，可以看出，当ＣＰＵ的工作电压为５Ｖ时，Ｃ１上的电压最高可充至４．６Ｖ，且Ｃ１上的电压是线性增加的。为了得到更佳的线性度和提高Ａ／Ｄ的转换速度，规定被测输入电压为０Ｖ～２．５Ｖ。Ａ／Ｄ转换时间小于２ｍｓ。　　　　<br>
　　改变Ｒ２、Ｃ１，可以获得不同速度、不同精度和分辨率的Ａ／Ｄ转换器。Ｒ２越大，Ｃ１充到２．５Ｖ所需时间越长，分辨率越高。若ＣＰＵ采用１２ＭＨｚ的晶振，定时器Ｔ１作为Ａ／Ｄ转换时间计数器，当Ｐ１．５变低启动Ａ／Ｄ转换时，允许Ｔ１开始定时，一直计到比较器输出变高为止，若需要８位Ａ／Ｄ，可选择Ｒ２＝２０ｋΩ，Ｃ１从０Ｖ充电至２．５Ｖ的时间为３９２μｓ。若Ｔ１的定时时间大于３９２μｓ，Ｔ１中断，认为输入电压高于２．５Ｖ； 若Ｔ１的定时时间小于３９２μｓ，则定时时间即为８位Ａ／Ｄ转换结果。若需１０位Ａ／Ｄ，可选Ｒ２＝８０ｋΩ，Ｃ１从０Ｖ充至２．５Ｖ所需时间为１４９０μｓ。若Ｔ１的定时时间大于１４９０μｓ，Ｔ１中断，认为输入电压高于２．５Ｖ； 若Ｔ１的定时时间小于１４９０μｓ，定时时间即为１０位Ａ／Ｄ转换结果。<br>
&nbsp;&nbsp;&nbsp;&nbsp;Ｃ１＝２７００ｐＦ，Ｒ２在不同阻值下Ａ／Ｄ转换的满度值见下表。<br>
　　 Ｒ２&nbsp;&nbsp;Ａ／Ｄ转换满度值&nbsp;&nbsp;&nbsp;低端死区值ｔ０<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;２０ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;３９２μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;４ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;３０ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;５７５ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;６ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;４０ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;７６２ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;９ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;５０ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;９４４ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１１ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;６０ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１１３８ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１４ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;７０ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１３１２ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１８ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;８０ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１４９０ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１９ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;９０ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１６７２ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;２０ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１００ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１８５８ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;２４ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１１０ｋ 　&nbsp;&nbsp;&nbsp;&nbsp;２０３５ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;２５ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;１２０ｋ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;２２１６ μｓ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;２６ μｓ<br>
&nbsp;&nbsp;&nbsp;&nbsp;市售Ａ／Ｄ转换器有些也存在死区，如ＩＮＴＥＬ１９６内部的１０位Ａ／Ｄ转换器在零点附近有６个ＬＳＢ的死区电压。将图４中Ｃ１刚开始充电时的波形放大，得到图５的波形。由图５可以看出，Ｃ１在开始启动Ａ／Ｄ转换时有一瞬时负压，ＣＰＵ内部的比较器在此期间不会发生比较翻转，这就是死区ｔ０。Ｔ０随Ｒ２和Ｃ１的不同而变化，如左下附表所示。消除ｔ０的方法是将Ａ／Ｄ转换值减去ｔ０作为实际值，在启动Ａ／Ｄ转换时延时ｔ０后再启动Ｔ１，这样Ａ／Ｄ转换值即为实际值。 <br>
&nbsp;&nbsp;&nbsp;&nbsp;Ｃ１用涤纶电容，Ｒ２用优于１％的金属膜电阻，加上合理的软件设计，Ａ／Ｄ转换的精度接近８位。最好不用电位器替代Ｒ２，长期工作精度不能保证。可以用电阻串并联的方式得到理想的Ａ／Ｄ转换精度。<br>
&nbsp;&nbsp;&nbsp;三、双积分式Ａ／Ｄ转换器<br>
&nbsp;&nbsp;&nbsp;单积分式Ａ／Ｄ转换器的缺点是精度受Ｒ２和Ｃ１的影响。在实际应用中，若需用多路Ａ／Ｄ转换，不妨采用图３所示电路。加一只ＣＤ４０５１，最多可对８路Ａ／Ｄ进行转换。在其中一路加上基准电压，设对基准电压Ｖｒｅｆ进行转换的结果为Ｔｒｅｆ，则由公式（２）可得：<br>
　　Ｖｒｅｆ＝Ｉ０×Ｔｒｅｆ／Ｃ１……（３）<br>
&nbsp;&nbsp;&nbsp;&nbsp;（２）式和（３）式比较得：<br>
&nbsp;&nbsp;&nbsp;&nbsp;Ｕｃ＝Ｖｒｅｆ×Ｔ／Ｔｒｅｆ……（４）<br>
&nbsp;&nbsp;&nbsp;&nbsp;这样，Ａ／Ｄ转换的结果只与基准电压Ｖｒｅｆ有关，与Ｒ２和Ｃ１无关。即是双积分Ａ／Ｄ转换器的工作原理。<br>
&nbsp;&nbsp;&nbsp;&nbsp;第一次转换时，先对基准电压Ｖｒｅｆ进行测量，测得结果为Ｔｒｅｆ，然后对被测电压进行测量，假设测值为Ｔ，则用软件计通过公式（４）算出被测电压。只要在这两次测量期间内，Ｒ２和Ｃ１保持相对不变即可。采用此方法，Ａ／Ｄ转换精度可优于８位，分辨率可达１２位。<br>
&nbsp;&nbsp;&nbsp;&nbsp;最后，需要说明的是：１． 若ＣＰＵ内部无比较器，也可在外部加一个廉价的比较器或运放来构成Ａ／Ｄ转换器。２． 本文介绍的Ａ／Ｄ转换器主要用在对价格要求苛刻的场合。３． 虽然电路的休止期较短，但建议两次Ａ／Ｄ转换的间隔要大于１００μｓ。<br>
<br>
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　山东&nbsp;&nbsp;李保军<br>
        <br>
         <a href="" target="_blank"> </a><br>
        <br>
        <img src="\dzbimg\2002\27\l1.jpg">　<img src="\dzbimg\2002\27\l2.jpg">　</font>
</span></td>
      </tr>
    </table>
    </center></div>
</body>
</html>
