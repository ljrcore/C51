C51 COMPILER V7.00  TEST76                                                                 09/18/2012 22:10:11 PAGE 1   


C51 COMPILER V7.00, COMPILATION OF MODULE TEST76
OBJECT MODULE PLACED IN TEST76.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE TEST76.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          ////////////////////////////////////////////////////////////////////////////
   2          //                给力者单片机开发学习系统，开发学习都给力！              //
   3          ////////////////////////////////////////////////////////////////////////////
   4          //                     学习51单片机，其实可以很简单                       //
   5          ////////////////////////////////////////////////////////////////////////////
   6          //                宁波芯动电子有限公司  www.MovingChip.com                //
   7          ////////////////////////////////////////////////////////////////////////////
   8          
   9          #include <AT89X52.h>       //调用51单片机的头文件
  10          #include <Intrins.h>    //因为本例中用到空操作_nop_();所以必须调用这个头文件
  11          
  12          //---------------------------------------
  13          //12864液晶相关I/O设置
  14          sbit RS=P2^0;                   //寄存器选择端 H:数据寄存器，L:命令寄存器
  15          sbit RW=P2^1;                   //读/写选择信号，R/W=1：读选通，R/W=0：写选通
  16          sbit E =P2^2;                   //读写使能信号，在E下降沿，数据被锁存(写)入,在E高电平器件，数据被读出
  17          sbit CS1=P2^3;                  //前64点选择，1有效
  18          sbit CS2=P2^4;                  //后64点选择，1有效
  19          sbit RST=P2^5;                  //复位信号
  20          sbit DB0=P0^7;                  //
  21          sbit DB1=P0^6;                  //
  22          sbit DB2=P0^5;                  //
  23          sbit DB3=P0^4;                  //
  24          sbit DB4=P0^3;                  //
  25          sbit DB5=P0^2;                  //
  26          sbit DB6=P0^1;                  //
  27          sbit DB7=P0^0;                  //
  28          //---------------------------------------
  29          
  30          //因为液晶无字库，数字和字库的字形需要用软件做出
  31          unsigned char code egk[]={
  32          /*--  文字:  0  --*/
  33          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  34          0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00,
  35          
  36          /*--  文字:  1  --*/
  37          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  38          0x00,0x10,0x10,0xF8,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,
  39          
  40          /*--  文字:  2  --*/
  41          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  42          0x00,0x70,0x08,0x08,0x08,0x88,0x70,0x00,0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00,
  43          
  44          /*--  文字:  3  --*/
  45          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  46          0x00,0x30,0x08,0x88,0x88,0x48,0x30,0x00,0x00,0x18,0x20,0x20,0x20,0x11,0x0E,0x00,
  47          
  48          /*--  文字:  4  --*/
  49          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  50          0x00,0x00,0xC0,0x20,0x10,0xF8,0x00,0x00,0x00,0x07,0x04,0x24,0x24,0x3F,0x24,0x00,
  51          
  52          /*--  文字:  5  --*/
  53          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  54          0x00,0xF8,0x08,0x88,0x88,0x08,0x08,0x00,0x00,0x19,0x21,0x20,0x20,0x11,0x0E,0x00,
  55          
C51 COMPILER V7.00  TEST76                                                                 09/18/2012 22:10:11 PAGE 2   

  56          /*--  文字:  6  --*/
  57          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  58          0x00,0xE0,0x10,0x88,0x88,0x18,0x00,0x00,0x00,0x0F,0x11,0x20,0x20,0x11,0x0E,0x00,
  59          
  60          /*--  文字:  7  --*/
  61          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  62          0x00,0x38,0x08,0x08,0xC8,0x38,0x08,0x00,0x00,0x00,0x00,0x3F,0x00,0x00,0x00,0x00,
  63          
  64          /*--  文字:  8  --*/
  65          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  66          0x00,0x70,0x88,0x08,0x08,0x88,0x70,0x00,0x00,0x1C,0x22,0x21,0x21,0x22,0x1C,0x00,
  67          
  68          /*--  文字:  9  --*/
  69          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  70          0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0x00,0x31,0x22,0x22,0x11,0x0F,0x00,
  71          
  72          /*--  文字:  a  --10*/
  73          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  74          0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x19,0x24,0x22,0x22,0x22,0x3F,0x20,
  75          
  76          /*--  文字:  b  --11*/
  77          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  78          0x08,0xF8,0x00,0x80,0x80,0x00,0x00,0x00,0x00,0x3F,0x11,0x20,0x20,0x11,0x0E,0x00,
  79          
  80          /*--  文字:  c  --12*/
  81          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  82          0x00,0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x00,0x0E,0x11,0x20,0x20,0x20,0x11,0x00,
  83          
  84          /*--  文字:  d  --13*/
  85          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  86          0x00,0x00,0x00,0x80,0x80,0x88,0xF8,0x00,0x00,0x0E,0x11,0x20,0x20,0x10,0x3F,0x20,
  87          
  88          /*--  文字:  e  --*/
  89          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  90          0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x1F,0x22,0x22,0x22,0x22,0x13,0x00,
  91          
  92          /*--  文字:  f  --*/
  93          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  94          0x00,0x80,0x80,0xF0,0x88,0x88,0x88,0x18,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,
  95          
  96          /*--  文字:  g  --16*/
  97          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
  98          0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x6B,0x94,0x94,0x94,0x93,0x60,0x00,
  99          
 100          /*--  文字:  h  --*/
 101          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 102          0x08,0xF8,0x00,0x80,0x80,0x80,0x00,0x00,0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20,
 103          
 104          /*--  文字:  i  --*/
 105          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 106          0x00,0x80,0x98,0x98,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,
 107          
 108          /*--  文字:  j  --19*/
 109          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 110          0x00,0x00,0x00,0x80,0x98,0x98,0x00,0x00,0x00,0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,
 111          
 112          /*--  文字:  k  --*/
 113          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 114          0x08,0xF8,0x00,0x00,0x80,0x80,0x80,0x00,0x20,0x3F,0x24,0x02,0x2D,0x30,0x20,0x00,
 115          
 116          /*--  文字:  l  --*/
 117          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
C51 COMPILER V7.00  TEST76                                                                 09/18/2012 22:10:11 PAGE 3   

 118          0x00,0x08,0x08,0xF8,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,
 119          
 120          /*--  文字:  m  --22*/
 121          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 122          0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x20,0x3F,0x20,0x00,0x3F,0x20,0x00,0x3F,
 123          
 124          /*--  文字:  n  --23*/
 125          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 126          0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x00,0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20,
 127          
 128          /*--  文字:  o  --24*/
 129          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 130          0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00,
 131          
 132          /*--  文字:  p  --*/
 133          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 134          0x80,0x80,0x00,0x80,0x80,0x00,0x00,0x00,0x80,0xFF,0xA1,0x20,0x20,0x11,0x0E,0x00,
 135          
 136          /*--  文字:  q  --*/
 137          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 138          0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x0E,0x11,0x20,0x20,0xA0,0xFF,0x80,
 139          
 140          /*--  文字:  r  --*/
 141          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 142          0x80,0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x20,0x20,0x3F,0x21,0x20,0x00,0x01,0x00,
 143                                                                                                                  
 144          
 145                                                             
 146          /*--  文字:  s  --*/
 147          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 148          0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x33,0x24,0x24,0x24,0x24,0x19,0x00,
 149          
 150          /*--  文字:  t  --*/
 151          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 152          0x00,0x80,0x80,0xE0,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x1F,0x20,0x20,0x00,0x00,
 153          
 154          /*--  文字:  u  --30*/
 155          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 156          0x80,0x80,0x00,0x00,0x00,0x80,0x80,0x00,0x00,0x1F,0x20,0x20,0x20,0x10,0x3F,0x20,
 157          
 158          /*--  文字:  v  --*/
 159          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 160          0x80,0x80,0x80,0x00,0x00,0x80,0x80,0x80,0x00,0x01,0x0E,0x30,0x08,0x06,0x01,0x00,
 161          
 162          /*--  文字:  w  --*/
 163          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 164          0x80,0x80,0x00,0x80,0x00,0x80,0x80,0x80,0x0F,0x30,0x0C,0x03,0x0C,0x30,0x0F,0x00,
 165          
 166          /*--  文字:  x  --*/
 167          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 168          0x00,0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x00,0x20,0x31,0x2E,0x0E,0x31,0x20,0x00,
 169          
 170          /*--  文字:  y  --*/
 171          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 172          0x80,0x80,0x80,0x00,0x00,0x80,0x80,0x80,0x80,0x81,0x8E,0x70,0x18,0x06,0x01,0x00,
 173          
 174          /*--  文字:  z  --35*/
 175          /*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
 176          0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x21,0x30,0x2C,0x22,0x21,0x30,0x00,
 177          
 178          /*--  文字:  A  --*/
 179          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
C51 COMPILER V7.00  TEST76                                                                 09/18/2012 22:10:11 PAGE 4   

 180          0x00,0x00,0xC0,0x38,0xE0,0x00,0x00,0x00,0x20,0x3C,0x23,0x02,0x02,0x27,0x38,0x20,
 181          
 182          /*--  文字:  B  --*/
 183          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 184          0x08,0xF8,0x88,0x88,0x88,0x70,0x00,0x00,0x20,0x3F,0x20,0x20,0x20,0x11,0x0E,0x00,
 185          
 186          /*--  文字:  C  --*/
 187          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 188          0xC0,0x30,0x08,0x08,0x08,0x08,0x38,0x00,0x07,0x18,0x20,0x20,0x20,0x10,0x08,0x00,
 189          
 190          /*--  文字:  D  --*/
 191          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 192          0x08,0xF8,0x08,0x08,0x08,0x10,0xE0,0x00,0x20,0x3F,0x20,0x20,0x20,0x10,0x0F,0x00,
 193          
 194          /*--  文字:  E  --*/
 195          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 196          0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,0x20,0x3F,0x20,0x20,0x23,0x20,0x18,0x00,
 197          
 198          /*--  文字:  F  --*/
 199          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 200          0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,0x20,0x3F,0x20,0x00,0x03,0x00,0x00,0x00,
 201          
 202          /*--  文字:  G  --*/
 203          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 204          0xC0,0x30,0x08,0x08,0x08,0x38,0x00,0x00,0x07,0x18,0x20,0x20,0x22,0x1E,0x02,0x00,
 205          
 206          /*--  文字:  H  --*/
 207          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 208          0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,0x20,0x3F,0x21,0x01,0x01,0x21,0x3F,0x20,
 209          
 210          /*--  文字:  I  --*/
 211          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 212          0x00,0x08,0x08,0xF8,0x08,0x08,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,
 213          
 214          /*--  文字:  J  --*/
 215          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 216          0x00,0x00,0x08,0x08,0xF8,0x08,0x08,0x00,0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,0x00,
 217          
 218          /*--  文字:  K  --*/
 219          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 220          0x08,0xF8,0x88,0xC0,0x28,0x18,0x08,0x00,0x20,0x3F,0x20,0x01,0x26,0x38,0x20,0x00,
 221          
 222          /*--  文字:  L  --*/
 223          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 224          0x08,0xF8,0x08,0x00,0x00,0x00,0x00,0x00,0x20,0x3F,0x20,0x20,0x20,0x20,0x30,0x00,
 225          
 226          /*--  文字:  M  --*/
 227          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 228          0x08,0xF8,0xF8,0x00,0xF8,0xF8,0x08,0x00,0x20,0x3F,0x00,0x3F,0x00,0x3F,0x20,0x00,
 229          
 230          /*--  文字:  N  --*/
 231          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 232          0x08,0xF8,0x30,0xC0,0x00,0x08,0xF8,0x08,0x20,0x3F,0x20,0x00,0x07,0x18,0x3F,0x00,
 233          
 234          /*--  文字:  O  --*/
 235          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 236          0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,0x0F,0x10,0x20,0x20,0x20,0x10,0x0F,0x00,
 237          
 238          /*--  文字:  P  --*/
 239          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 240          0x08,0xF8,0x08,0x08,0x08,0x08,0xF0,0x00,0x20,0x3F,0x21,0x01,0x01,0x01,0x00,0x00,
 241          
C51 COMPILER V7.00  TEST76                                                                 09/18/2012 22:10:11 PAGE 5   

 242          /*--  文字:  Q  --*/
 243          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 244          0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,0x0F,0x18,0x24,0x24,0x38,0x50,0x4F,0x00,
 245          
 246          /*--  文字:  R  --*/
 247          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 248          0x08,0xF8,0x88,0x88,0x88,0x88,0x70,0x00,0x20,0x3F,0x20,0x00,0x03,0x0C,0x30,0x20,
 249          
 250          /*--  文字:  S  --*/
 251          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 252          0x00,0x70,0x88,0x08,0x08,0x08,0x38,0x00,0x00,0x38,0x20,0x21,0x21,0x22,0x1C,0x00,
 253          
 254          /*--  文字:  T  --*/
 255          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 256          0x18,0x08,0x08,0xF8,0x08,0x08,0x18,0x00,0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,
 257          
 258          /*--  文字:  U  --*/
 259          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 260          0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00,
 261          
 262          /*--  文字:  V  --*/
 263          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 264          0x08,0x78,0x88,0x00,0x00,0xC8,0x38,0x08,0x00,0x00,0x07,0x38,0x0E,0x01,0x00,0x00,
 265          
 266          /*--  文字:  W  --*/
 267          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 268          0xF8,0x08,0x00,0xF8,0x00,0x08,0xF8,0x00,0x03,0x3C,0x07,0x00,0x07,0x3C,0x03,0x00,
 269          
 270          /*--  文字:  X  --*/
 271          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 272          0x08,0x18,0x68,0x80,0x80,0x68,0x18,0x08,0x20,0x30,0x2C,0x03,0x03,0x2C,0x30,0x20,
 273          
 274          /*--  文字:  Y  --*/
 275          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 276          0x08,0x38,0xC8,0x00,0xC8,0x38,0x08,0x00,0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,
 277          
 278          /*--  文字:  Z  --*/
 279          /*--  Trebuchet MS12;  此字体下对应的点阵为：宽x高=8x16   --*/
 280          0x10,0x08,0x08,0x08,0xC8,0x38,0x08,0x00,0x20,0x38,0x26,0x21,0x20,0x20,0x18,0x00,  
 281          
 282          };
 283          //---------------------------------------
 284          //名称：液晶用延时函数
 285          //适用：给力者GL9单片机开发学习系统
 286          //公司：宁波芯动电子有限公司
 287          //网址：www.MovingChip.com
 288          //日期：20120918
 289          //---------------------------------------
 290          void delay(unsigned int t)
 291          {
 292   1              unsigned int i;
 293   1              for(i=0;i<t;i++);       
 294   1      }
 295                  
 296          //---------------------------------------
 297          //名称：字节内位数据位置转换函数
 298          //适用：给力者GL9单片机开发学习系统
 299          //公司：宁波芯动电子有限公司
 300          //网址：www.MovingChip.com
 301          //日期：20120918
 302          //---------------------------------------
 303          unsigned char num(unsigned char dat)
C51 COMPILER V7.00  TEST76                                                                 09/18/2012 22:10:11 PAGE 6   

 304          {
 305   1         unsigned char val;
 306   1              val = ((dat & 0x01) << 7) | ((dat & 0x02) << 5) | ((dat & 0x04) << 3) | ((dat & 0x08) << 1) |
 307   1         ((dat & 0x10) >> 1) | ((dat & 0x20) >> 3) | ((dat & 0x40) >> 5) | ((dat & 0x80) >> 7);
 308   1         return  val;
 309   1      } 
 310          //---------------------------------------
 311          //名称：写命令函数
 312          //适用：给力者GL9单片机开发学习系统
 313          //公司：宁波芯动电子有限公司
 314          //网址：www.MovingChip.com
 315          //日期：20120918
 316          //---------------------------------------
 317          void write_com(unsigned char cmdcode)
 318          {                                          
 319   1              RS=0;                           //选择命令寄存器
 320   1              RW=0;                           //写选通
 321   1              P0=num(cmdcode);    //将命令写入总线
 322   1              _nop_();            //空操作，做短暂的延时
 323   1              E=1;                    //E的下降沿，数据写入
 324   1              _nop_();            //空操作，做短暂的延时
 325   1              E=0;                    //E的下降沿，数据写入
 326   1      }
 327          //---------------------------------------
 328          //名称：写数据函数
 329          //适用：给力者GL9单片机开发学习系统
 330          //公司：宁波芯动电子有限公司
 331          //网址：www.MovingChip.com
 332          //日期：20120918
 333          //---------------------------------------
 334          void write_data(unsigned char Rsspdata)
 335          {
 336   1      
 337   1              RS=1;                           //选择数据寄存器
 338   1              RW=0;                           //写选通
 339   1              P0=num(Rsspdata);   //将数据写入总线
 340   1              _nop_();            //空操作，做短暂的延时
 341   1              E=1;                    //E的下降沿，数据写入
 342   1              _nop_();            //空操作，做短暂的延时
 343   1              E=0;                    //E的下降沿，数据写入
 344   1      } 
 345          
 346          //---------------------------------------
 347          //名称：清屏函数
 348          //适用：给力者GL9单片机开发学习系统
 349          //公司：宁波芯动电子有限公司
 350          //网址：www.MovingChip.com
 351          //日期：20120918
 352          //---------------------------------------
 353          void Clr_Scr(void)
 354          {
 355   1              unsigned char j,k;
 356   1              CS1=1;                                                  //左半屏选通
 357   1              CS2=1;                                                  //右半屏选通
 358   1              write_com(0x40+0);         //将列地址写入  
 359   1                      //列地址格式为: 0 1 C5 C4 C3 C2 C1 C0,其中C5-C0=0~0x3f
 360   1                      //分别代表1~64列
 361   1              for(k=0;k<8;k++)
 362   1              {
 363   2                      write_com(0xb8+k);     //将行地址写入   
 364   2                      //行地址格式为: 1 0 1 1 1 P2 P1 P0,其中P3-C0=0~0x07
 365   2                      //分别代表1~8行
C51 COMPILER V7.00  TEST76                                                                 09/18/2012 22:10:11 PAGE 7   

 366   2      
 367   2                      for(j=0;j<64;j++)               //每行的64列都写0，因为选了左右两屏，
 368   2                      {
 369   3                              write_data(0x00);       //64列同时写0
 370   3                      }
 371   2              }
 372   1      } 
 373                  
 374          //---------------------------------------
 375          //名称：地址写入函数
 376          //适用：给力者GL9单片机开发学习系统
 377          //公司：宁波芯动电子有限公司
 378          //网址：www.MovingChip.com
 379          //日期：20120918
 380          //---------------------------------------
 381          void werite_x_y(unsigned char x,unsigned char y)
 382          {
 383   1              y=y&0x7f;                                 //限定范围，列不能超过128
 384   1              x=x&0x07;                                 //限定范围，行不能超过8
 385   1              if(y<64)                  //如果列小于64
 386   1              {
 387   2                      CS1=1;                 //选通左半屏
 388   2                      CS2=0;                 //关闭右半屏
 389   2                      write_com(0x40+y);     //将列地址写入  
 390   2                      //列地址格式为: 0 1 C5 C4 C3 C2 C1 C0,其中C5-C0=0~0x3f
 391   2                      //分别代表1~64列
 392   2              }
 393   1              else
 394   1              {
 395   2                      CS1=0;                 //关闭左半屏
 396   2                      CS2=1;                 //选通右半屏
 397   2                      y&=0x3f;
 398   2                      write_com(0x40+y);     //将列地址写入  
 399   2                      //列地址格式为: 0 1 C5 C4 C3 C2 C1 C0,其中C5-C0=0~0x3f
 400   2                      //分别代表1~64列        
 401   2              }
 402   1              write_com(0xb8+x);     //将行地址写入   
 403   1                      //行地址格式为: 1 0 1 1 1 P2 P1 P0,其中P3-C0=0~0x07
 404   1                      //分别代表1~8行
 405   1      } 
 406          
 407          //---------------------------------------
 408          //名称：指定位置写8*16字符函数
 409          //适用：给力者GL9单片机开发学习系统
 410          //公司：宁波芯动电子有限公司
 411          //网址：www.MovingChip.com
 412          //日期：20120918
 413          //---------------------------------------
 414          void write_english(unsigned char x,unsigned char y, unsigned char en)
 415          {
 416   1         unsigned char i=0;   
 417   1              werite_x_y(x,y);          //设定起始地址
 418   1      
 419   1              //en为索引，每个数字或英文占用16个字节，首地址为(en-1)*32
 420   1              for(i=0;i<8;i++) write_data(egk[en*16+i]);      //先写上半个字，共8个字节
 421   1      
 422   1              werite_x_y(x+1,y);        //设定起始地址，此次将行地址加1，以便写下行
 423   1      
 424   1              for(i=0;i<8;i++) write_data(egk[en*16+8+i]);    //再写下半个字，共8个字节
 425   1              
 426   1      }
 427          
C51 COMPILER V7.00  TEST76                                                                 09/18/2012 22:10:11 PAGE 8   

 428          //---------------------------------------
 429          //名称：12864初始化函数
 430          //适用：给力者GL9单片机开发学习系统
 431          //公司：宁波芯动电子有限公司
 432          //网址：www.MovingChip.com
 433          //日期：20120918
 434          //--------------------------------------- 
 435          void init_lcd(void)
 436          {          
 437   1              RST=0;                 //液晶复位
 438   1              delay(250);            //适当延时
 439   1              RST=1;                 //复位结束
 440   1              CS1=1;                                    //左半屏选通
 441   1              CS2=1;                                    //右半屏选通  
 442   1              delay(250);            //适当延时
 443   1              write_com(0x3f);       //显示开
 444   1      }  
 445          //---------------------------------------
 446          //名称: 主函数
 447          //适用：给力者GL9单片机开发学习系统
 448          //公司：宁波芯动电子有限公司
 449          //网址：www.MovingChip.com
 450          //日期：20120918
 451          //---------------------------------------       
 452          void main()
 453          {  
 454   1              unsigned int i,k;
 455   1              init_lcd();                                       //初始化液晶
 456   1              Clr_Scr();                                        //清屏
 457   1              while(1)
 458   1              {                       
 459   2                      if(++i>20000)
 460   2              {
 461   3                      i=0;
 462   3                      if(++k>50000) k=0;
 463   3                      write_english(0,0,k/10000);                             //万位  
 464   3                              write_english(0,8,(k%10000)/1000);   //千位
 465   3                              write_english(0,16,(k%1000)/100);       //百位
 466   3                              write_english(0,24,(k%100)/10);                 //十位
 467   3                              write_english(0,32,k%10);                                                       //个位  
 468   3                      }
 469   2              }
 470   1      }
 471          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    509    ----
   CONSTANT SIZE    =    992    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
